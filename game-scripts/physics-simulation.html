<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç‰©ç†å¼•æ“æ¨¡æ‹Ÿ - BDCGæ¨¡æ‹Ÿå™¨</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/atom-one-dark.min.css">
    <style>
        :root {
            --primary-color: #3a0ca3;
            --secondary-color: #4361ee;
            --accent-color: #f72585;
            --tech-art-color: #4cc9f0;
            --animation-color: #7209b7;
            --scene-color: #38b000;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --code-bg: #282c34;
            --card-bg: #ffffff;
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark-color);
            line-height: 1.6;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* å¤´éƒ¨å¯¼èˆª */
        .subpage-header {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 1.5rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.2);
            transition: var(--transition);
        }

        .back-button:hover {
            background-color: rgba(255, 255, 255, 0.3);
            transform: translateX(-5px);
        }

        .subpage-title {
            text-align: center;
            flex-grow: 1;
        }

        .subpage-title h1 {
            font-size: 2rem;
            margin-bottom: 0.3rem;
        }

        .subpage-title p {
            opacity: 0.9;
            font-size: 1rem;
        }

        .header-actions {
            display: flex;
            gap: 1rem;
        }

        .header-actions a {
            color: white;
            text-decoration: none;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            background-color: rgba(255, 255, 255, 0.2);
            transition: var(--transition);
        }

        .header-actions a:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        /* ä¸»è¦å†…å®¹ */
        .main-content {
            padding: 3rem 0;
        }

        .page-section {
            background-color: var(--card-bg);
            border-radius: 12px;
            padding: 2rem;
            box-shadow: var(--shadow);
            margin-bottom: 2.5rem;
        }

        .section-title {
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid var(--accent-color);
            display: inline-block;
        }

        .section-subtitle {
            color: var(--secondary-color);
            margin: 1.5rem 0 1rem;
            font-size: 1.3rem;
        }

        /* ä¸“ä¸šé¢†åŸŸæ ‡ç­¾ */
        .domain-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .domain-tag {
            padding: 0.5rem 1.2rem;
            border-radius: 20px;
            font-weight: 600;
            color: white;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .domain-tag.tech-art {
            background-color: var(--tech-art-color);
        }

        .domain-tag.animation {
            background-color: var(--animation-color);
        }

        .domain-tag.scene-art {
            background-color: var(--scene-color);
        }

        /* é¡¹ç›®æ¦‚è§ˆ */
        .project-overview {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 2rem;
        }

        @media (max-width: 992px) {
            .project-overview {
                grid-template-columns: 1fr;
            }
        }

        .project-description p {
            margin-bottom: 1.2rem;
            color: var(--dark-color);
        }

        .project-meta {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
        }

        .meta-item {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem 0;
            border-bottom: 1px solid #dee2e6;
        }

        .meta-item:last-child {
            border-bottom: none;
        }

        .meta-label {
            font-weight: 600;
            color: var(--primary-color);
        }

        .meta-value {
            color: var(--gray-color);
        }

        /* æŠ€æœ¯å±•ç¤ºç½‘æ ¼ */
        .tech-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .tech-card {
            background-color: #f8f9fa;
            border-radius: 10px;
            padding: 1.5rem;
            transition: var(--transition);
            border-top: 4px solid var(--secondary-color);
        }

        .tech-card.tech-art {
            border-top-color: var(--tech-art-color);
        }

        .tech-card.animation {
            border-top-color: var(--animation-color);
        }

        .tech-card.scene-art {
            border-top-color: var(--scene-color);
        }

        .tech-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15);
        }

        .tech-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            color: var(--secondary-color);
        }

        .tech-card.tech-art .tech-icon {
            color: var(--tech-art-color);
        }

        .tech-card.animation .tech-icon {
            color: var(--animation-color);
        }

        .tech-card.scene-art .tech-icon {
            color: var(--scene-color);
        }

        .tech-card h4 {
            color: var(--primary-color);
            margin-bottom: 0.8rem;
            font-size: 1.3rem;
        }

        .tech-card p {
            color: var(--gray-color);
            font-size: 0.95rem;
            margin-bottom: 1.2rem;
        }

        .tech-features {
            list-style-type: none;
        }

        .tech-features li {
            padding: 0.4rem 0;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .tech-features li:last-child {
            border-bottom: none;
        }

        .tech-features li i {
            color: var(--accent-color);
            font-size: 0.9rem;
        }

        /* ä»£ç æ¼”ç¤º */
        .code-demo {
            background-color: var(--code-bg);
            border-radius: 8px;
            overflow: hidden;
            margin: 1.5rem 0;
        }

        .code-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgba(0, 0, 0, 0.2);
            padding: 0.8rem 1.2rem;
            color: #abb2bf;
        }

        .code-title {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .copy-button {
            background-color: rgba(255, 255, 255, 0.1);
            border: none;
            color: #abb2bf;
            padding: 0.3rem 0.8rem;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
        }

        .copy-button:hover {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
        }

        pre {
            margin: 0;
            padding: 1.5rem;
            overflow-x: auto;
            line-height: 1.5;
        }

        code {
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
        }

        .hljs {
            background: transparent;
        }

        /* å¯è§†åŒ–æ¼”ç¤º */
        .demo-container {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            position: relative;
            overflow: hidden;
            min-height: 400px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .demo-title {
            color: white;
            text-align: center;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }

        .physics-canvas {
            width: 100%;
            height: 300px;
            background-color: rgba(0, 0, 0, 0.3);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .demo-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1.5rem;
            justify-content: center;
        }

        .demo-button {
            background-color: rgba(67, 97, 238, 0.7);
            color: white;
            border: none;
            padding: 0.7rem 1.2rem;
            border-radius: 6px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
        }

        .demo-button:hover {
            background-color: rgba(67, 97, 238, 0.9);
            transform: translateY(-3px);
        }

        .demo-button.reset {
            background-color: rgba(247, 37, 133, 0.7);
        }

        .demo-button.reset:hover {
            background-color: rgba(247, 37, 133, 0.9);
        }

        /* æ–‡ä»¶ç»“æ„ */
        .file-structure {
            background-color: #f8f9fa;
            border-radius: 8px;
            padding: 1.5rem;
            margin: 1.5rem 0;
        }

        .file-tree {
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            line-height: 1.8;
        }

        .file-tree ul {
            list-style-type: none;
            padding-left: 1.5rem;
        }

        .file-tree li {
            position: relative;
            padding: 0.2rem 0;
        }

        .file-tree li:before {
            content: "ğŸ“";
            position: absolute;
            left: -1.2rem;
        }

        .file-tree .file:before {
            content: "ğŸ“„";
        }

        .file-tree .js-file:before {
            content: "ğŸ“œ";
        }

        .file-tree .shader-file:before {
            content: "ğŸ”®";
        }

        .file-tree .scene-file:before {
            content: "ğŸ¬";
        }

        /* ç›¸å…³èµ„æº */
        .resource-links {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .resource-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--secondary-color);
            text-decoration: none;
            padding: 0.7rem 1.2rem;
            background-color: rgba(67, 97, 238, 0.1);
            border-radius: 6px;
            transition: var(--transition);
        }

        .resource-link:hover {
            background-color: rgba(67, 97, 238, 0.2);
            transform: translateY(-3px);
        }

        /* é¡µé¢å¯¼èˆª */
        .page-navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 3rem;
            padding-top: 2rem;
            border-top: 1px solid #dee2e6;
        }

        .nav-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-color);
            text-decoration: none;
            padding: 0.8rem 1.5rem;
            background-color: white;
            border-radius: 6px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: var(--transition);
        }

        .nav-button:hover {
            background-color: var(--primary-color);
            color: white;
            transform: translateY(-3px);
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 1rem;
                text-align: center;
            }
            
            .header-actions {
                justify-content: center;
            }
            
            .subpage-title h1 {
                font-size: 1.7rem;
            }
            
            .tech-grid {
                grid-template-columns: 1fr;
            }
            
            .page-navigation {
                flex-direction: column;
                gap: 1rem;
            }
            
            .nav-button {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <header class="subpage-header">
        <div class="container">
            <div class="header-content">
                <a href="../index.html" class="back-button">
                    <i class="fas fa-arrow-left"></i> è¿”å›ä¸»é¡µ
                </a>
                
                <div class="subpage-title">
                    <h1>ç‰©ç†å¼•æ“æ¨¡æ‹Ÿ</h1>
                    <p>æŠ€æœ¯ç¾æœ¯ã€åŠ¨ç”»å¼•æ“ä¸åœºæ™¯è‰ºæœ¯çš„ç»¼åˆåº”ç”¨</p>
                </div>
                
                <div class="header-actions">
                    <a href="#tech-demo"><i class="fas fa-cogs"></i> æŠ€æœ¯æ¼”ç¤º</a>
                    <a href="#code-demo"><i class="fas fa-code"></i> ä»£ç </a>
                    <a href="#case-studies"><i class="fas fa-book"></i> æ¡ˆä¾‹</a>
                </div>
            </div>
        </div>
    </header>

    <main class="main-content container">
        <!-- é¡¹ç›®æ¦‚è§ˆ -->
        <section class="page-section">
            <h2 class="section-title">é¡¹ç›®æ¦‚è§ˆ</h2>
            
            <div class="domain-tags">
                <div class="domain-tag tech-art">
                    <i class="fas fa-paint-brush"></i> æŠ€æœ¯ç¾æœ¯
                </div>
                <div class="domain-tag animation">
                    <i class="fas fa-film"></i> åŠ¨ç”»å¼•æ“
                </div>
                <div class="domain-tag scene-art">
                    <i class="fas fa-mountain"></i> åœºæ™¯è‰ºæœ¯
                </div>
            </div>
            
            <div class="project-overview">
                <div class="project-description">
                    <p>è¿™æ˜¯ä¸€ä¸ªç»¼åˆæ€§çš„ç‰©ç†å¼•æ“æ¨¡æ‹Ÿé¡¹ç›®ï¼Œæ•´åˆäº†æŠ€æœ¯ç¾æœ¯ã€åŠ¨ç”»å¼•æ“å’Œåœºæ™¯è‰ºæœ¯ä¸‰å¤§é¢†åŸŸã€‚ç³»ç»ŸåŸºäº2D/3Dç‰©ç†å¼•æ“ï¼Œå®ç°äº†åˆšä½“åŠ¨åŠ›å­¦ã€ç¢°æ’æ£€æµ‹ã€ç²’å­ç³»ç»Ÿã€å¸ƒæ–™æ¨¡æ‹Ÿå’Œæµä½“åŠ¨åŠ›å­¦ç­‰é«˜çº§ç‰©ç†æ•ˆæœã€‚</p>
                    
                    <p>é¡¹ç›®é‡ç‚¹å…³æ³¨ç‰©ç†æ•ˆæœä¸è§†è§‰è¡¨ç°çš„ç»“åˆï¼Œé€šè¿‡ç€è‰²å™¨ç¼–ç¨‹ã€é¡¶ç‚¹åŠ¨ç”»å’ŒåæœŸå¤„ç†æŠ€æœ¯ï¼Œå°†ç‰©ç†æ¨¡æ‹Ÿç»“æœè½¬åŒ–ä¸ºé€¼çœŸçš„è§†è§‰ä½“éªŒã€‚ç³»ç»Ÿæ”¯æŒå®æ—¶ç¼–è¾‘å’Œå‚æ•°è°ƒæ•´ï¼Œä¾¿äºç¾æœ¯å¸ˆå’Œè®¾è®¡å¸ˆå¿«é€Ÿè¿­ä»£ã€‚</p>
                    
                    <p>æœ¬é¡µé¢å°†å±•ç¤ºæ ¸å¿ƒç‰©ç†ç®—æ³•ã€æŠ€æœ¯ç¾æœ¯å®ç°æ–¹æ³•ã€åŠ¨ç”»ç³»ç»Ÿé›†æˆæ–¹æ¡ˆï¼Œä»¥åŠåœºæ™¯è‰ºæœ¯ä¸ç‰©ç†äº¤äº’çš„æ¡ˆä¾‹ç ”ç©¶ã€‚</p>
                </div>
                
                <div class="project-meta">
                    <div class="meta-item">
                        <span class="meta-label">æŠ€æœ¯æ ˆ:</span>
                        <span class="meta-value">TypeScript + WebGL/WebGPU</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">æ–‡ä»¶æ•°é‡:</span>
                        <span class="meta-value">28ä¸ª</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">æœ€åæ›´æ–°:</span>
                        <span class="meta-value">2023-10-20</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">å¤æ‚åº¦:</span>
                        <span class="meta-value">é«˜çº§</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">ç‰©ç†åº“:</span>
                        <span class="meta-value">è‡ªå®šä¹‰ + Cannon.js</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">æ¸²æŸ“å™¨:</span>
                        <span class="meta-value">Three.js + è‡ªå®šä¹‰ç€è‰²å™¨</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- æŠ€æœ¯é¢†åŸŸå±•ç¤º -->
        <section class="page-section">
            <h2 class="section-title">æŠ€æœ¯é¢†åŸŸ</h2>
            
            <div class="tech-grid">
                <!-- æŠ€æœ¯ç¾æœ¯ -->
                <div class="tech-card tech-art">
                    <div class="tech-icon">
                        <i class="fas fa-paint-brush"></i>
                    </div>
                    <h4>æŠ€æœ¯ç¾æœ¯ (Tech Art)</h4>
                    <p>å°†ç‰©ç†æ¨¡æ‹Ÿä¸è§†è§‰è¡¨ç°ç»“åˆï¼Œé€šè¿‡ç€è‰²å™¨ã€æè´¨å’ŒåæœŸå¤„ç†å¢å¼ºç‰©ç†æ•ˆæœçš„çœŸå®æ„Ÿã€‚</p>
                    <ul class="tech-features">
                        <li><i class="fas fa-check"></i> åŸºäºç‰©ç†çš„æ¸²æŸ“(PBR)</li>
                        <li><i class="fas fa-check"></i> ç€è‰²å™¨ç¼–ç¨‹(HLSL/GLSL)</li>
                        <li><i class="fas fa-check"></i> é¡¶ç‚¹/ç‰‡æ®µç€è‰²å™¨ç‰¹æ•ˆ</li>
                        <li><i class="fas fa-check"></i> å±å¹•ç©ºé—´æ•ˆæœ</li>
                        <li><i class="fas fa-check"></i> æè´¨ç³»ç»Ÿ</li>
                    </ul>
                </div>
                
                <!-- åŠ¨ç”»å¼•æ“ -->
                <div class="tech-card animation">
                    <div class="tech-icon">
                        <i class="fas fa-film"></i>
                    </div>
                    <h4>åŠ¨ç”»å¼•æ“</h4>
                    <p>å°†ç‰©ç†æ¨¡æ‹Ÿä¸è§’è‰²åŠ¨ç”»ã€ç‰¹æ•ˆåŠ¨ç”»ç»“åˆï¼Œåˆ›å»ºåŸºäºç‰©ç†çš„åŠ¨ç”»ç³»ç»Ÿã€‚</p>
                    <ul class="tech-features">
                        <li><i class="fas fa-check"></i> åˆšä½“/æŸ”ä½“åŠ¨ç”»</li>
                        <li><i class="fas fa-check"></i> é€†å‘è¿åŠ¨å­¦(IK)æ±‚è§£</li>
                        <li><i class="fas fa-check"></i> å¸ƒæ–™ä¸å¤´å‘æ¨¡æ‹Ÿ</li>
                        <li><i class="fas fa-check"></i> ç²’å­ç³»ç»Ÿ</li>
                        <li><i class="fas fa-check"></i> éª¨éª¼åŠ¨ç”»ä¸ç‰©ç†èåˆ</li>
                    </ul>
                </div>
                
                <!-- åœºæ™¯è‰ºæœ¯ -->
                <div class="tech-card scene-art">
                    <div class="tech-icon">
                        <i class="fas fa-mountain"></i>
                    </div>
                    <h4>åœºæ™¯è‰ºæœ¯</h4>
                    <p>åˆ›å»ºä¸ç‰©ç†ç³»ç»Ÿäº¤äº’çš„ç¯å¢ƒå…ƒç´ ï¼Œå®ç°åŠ¨æ€ã€å¯ç ´åçš„åœºæ™¯ã€‚</p>
                    <ul class="tech-features">
                        <li><i class="fas fa-check"></i> å¯ç ´ååœ°å½¢ç³»ç»Ÿ</li>
                        <li><i class="fas fa-check"></i> æ¤è¢«ä¸ç‰©ç†äº¤äº’</li>
                        <li><i class="fas fa-check"></i> æµä½“ä¸æ°´ä½“æ¨¡æ‹Ÿ</li>
                        <li><i class="fas fa-check"></i> åŠ¨æ€å…‰ç…§ä¸é˜´å½±</li>
                        <li><i class="fas fa-check"></i> ç¯å¢ƒç²’å­æ•ˆæœ</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- æŠ€æœ¯æ¼”ç¤º -->
        <section class="page-section" id="tech-demo">
            <h2 class="section-title">ç‰©ç†æ¨¡æ‹Ÿæ¼”ç¤º</h2>
            
            <div class="demo-container">
                <h3 class="demo-title">2Dç‰©ç†å¼•æ“æ¼”ç¤º</h3>
                <canvas id="physicsCanvas" class="physics-canvas" width="800" height="300">
                    æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒCanvaså…ƒç´ ï¼Œè¯·å‡çº§æµè§ˆå™¨ä»¥æŸ¥çœ‹æ¼”ç¤ºã€‚
                </canvas>
                <div class="demo-controls">
                    <button class="demo-button" id="addBoxBtn">
                        <i class="fas fa-cube"></i> æ·»åŠ æ–¹å—
                    </button>
                    <button class="demo-button" id="addCircleBtn">
                        <i class="fas fa-circle"></i> æ·»åŠ åœ†å½¢
                    </button>
                    <button class="demo-button" id="addPolygonBtn">
                        <i class="fas fa-star"></i> æ·»åŠ å¤šè¾¹å½¢
                    </button>
                    <button class="demo-button" id="toggleGravityBtn">
                        <i class="fas fa-weight-hanging"></i> åˆ‡æ¢é‡åŠ›
                    </button>
                    <button class="demo-button reset" id="resetBtn">
                        <i class="fas fa-redo"></i> é‡ç½®åœºæ™¯
                    </button>
                </div>
            </div>
            
            <p>è¿™æ˜¯ä¸€ä¸ªç®€åŒ–çš„2Dç‰©ç†å¼•æ“æ¼”ç¤ºï¼Œå±•ç¤ºäº†åˆšä½“åŠ¨åŠ›å­¦ã€ç¢°æ’æ£€æµ‹å’Œé‡åŠ›æ¨¡æ‹Ÿã€‚æ‚¨å¯ä»¥æ·»åŠ ä¸åŒå½¢çŠ¶çš„ç‰©ä½“ï¼Œè§‚å¯Ÿå®ƒä»¬ä¹‹é—´çš„ç‰©ç†äº¤äº’ã€‚</p>
        </section>

        <!-- ä»£ç æ¼”ç¤º -->
        <section class="page-section" id="code-demo">
            <h2 class="section-title">æ ¸å¿ƒä»£ç å®ç°</h2>
            
            <h3 class="section-subtitle">ç‰©ç†å¼•æ“æ ¸å¿ƒ (PhysicsEngine.js)</h3>
            <div class="code-demo">
                <div class="code-header">
                    <div class="code-title">
                        <i class="fas fa-file-code"></i>
                        <span>physics-simulation/core/PhysicsEngine.js</span>
                    </div>
                    <button class="copy-button" onclick="copyCode('code1')">
                        <i class="far fa-copy"></i> å¤åˆ¶ä»£ç 
                    </button>
                </div>
                <pre><code class="javascript" id="code1">/**
 * ç‰©ç†å¼•æ“æ¨¡æ‹Ÿ - æ ¸å¿ƒå¼•æ“
 * è´Ÿè´£ç®¡ç†ç‰©ç†ä¸–ç•Œã€åˆšä½“ã€ç¢°æ’æ£€æµ‹å’Œç‰©ç†æ›´æ–°
 */
class PhysicsEngine {
    constructor(config = {}) {
        this.gravity = config.gravity || { x: 0, y: 0.5 };
        this.worldBounds = config.bounds || { 
            left: 0, right: 800, top: 0, bottom: 600 
        };
        
        // ç‰©ç†å®ä½“é›†åˆ
        this.bodies = [];
        
        // ç¢°æ’æ£€æµ‹ç³»ç»Ÿ
        this.collisionSystem = new CollisionSystem();
        
        // æ—¶é—´æ­¥é•¿ç®¡ç†
        this.timeStep = 1 / 60; // 60 FPS
        this.accumulator = 0;
        this.lastTime = 0;
        
        // ç‰©ç†çº¦æŸ
        this.constraints = [];
        
        // æ€§èƒ½ç»Ÿè®¡
        this.stats = {
            updateCount: 0,
            collisionChecks: 0,
            bodiesCount: 0
        };
    }
    
    /**
     * æ›´æ–°ç‰©ç†ä¸–ç•Œ
     */
    update(currentTime) {
        if (this.lastTime === 0) {
            this.lastTime = currentTime;
            return;
        }
        
        // è®¡ç®—æ—¶é—´å·®
        let deltaTime = (currentTime - this.lastTime) / 1000; // è½¬æ¢ä¸ºç§’
        this.lastTime = currentTime;
        
        // é™åˆ¶æœ€å¤§æ—¶é—´æ­¥é•¿ï¼Œé¿å…"spiral of death"
        deltaTime = Math.min(deltaTime, 0.1);
        
        // ç´¯ç§¯æ—¶é—´
        this.accumulator += deltaTime;
        
        // æ‰§è¡Œå›ºå®šæ—¶é—´æ­¥é•¿æ›´æ–°
        while (this.accumulator >= this.timeStep) {
            this.fixedUpdate(this.timeStep);
            this.accumulator -= this.timeStep;
            this.stats.updateCount++;
        }
        
        // æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
        this.stats.bodiesCount = this.bodies.length;
    }
    
    /**
     * å›ºå®šæ—¶é—´æ­¥é•¿æ›´æ–°
     */
    fixedUpdate(dt) {
        // åº”ç”¨é‡åŠ›
        this.applyGravity(dt);
        
        // æ›´æ–°ç‰©ä½“ä½ç½®å’Œé€Ÿåº¦
        this.updateBodies(dt);
        
        // æ£€æµ‹å’Œå¤„ç†ç¢°æ’
        this.detectCollisions();
        
        // åº”ç”¨çº¦æŸ
        this.applyConstraints();
        
        // æ›´æ–°AABBè¾¹ç•Œæ¡†
        this.updateBounds();
    }
    
    /**
     * åº”ç”¨é‡åŠ›
     */
    applyGravity(dt) {
        for (let body of this.bodies) {
            if (body.isStatic || !body.affectedByGravity) continue;
            
            // v = v + g * dt
            body.velocity.x += this.gravity.x * dt;
            body.velocity.y += this.gravity.y * dt;
        }
    }
    
    /**
     * æ›´æ–°æ‰€æœ‰ç‰©ç†å®ä½“
     */
    updateBodies(dt) {
        for (let body of this.bodies) {
            if (body.isStatic) continue;
            
            // åŠéšå¼æ¬§æ‹‰æ³•ç§¯åˆ†
            // v = v + a * dt
            body.velocity.x += body.acceleration.x * dt;
            body.velocity.y += body.acceleration.y * dt;
            
            // åº”ç”¨é˜»å°¼
            body.velocity.x *= body.damping;
            body.velocity.y *= body.damping;
            
            // p = p + v * dt
            body.position.x += body.velocity.x * dt;
            body.position.y += body.velocity.y * dt;
            
            // æ›´æ–°è§’é€Ÿåº¦
            body.angularVelocity += body.torque * body.inverseInertia * dt;
            body.angularVelocity *= body.angularDamping;
            
            // æ›´æ–°è§’åº¦
            body.angle += body.angularVelocity * dt;
            
            // é‡ç½®åŠ é€Ÿåº¦å’Œæ‰­çŸ©
            body.acceleration.set(0, 0);
            body.torque = 0;
        }
    }
    
    /**
     * æ£€æµ‹å’Œå¤„ç†ç¢°æ’
     */
    detectCollisions() {
        this.stats.collisionChecks = 0;
        
        // æ¸…ç©ºä¸Šæ¬¡çš„ç¢°æ’ä¿¡æ¯
        for (let body of this.bodies) {
            body.collisions = [];
        }
        
        // å®½é˜¶æ®µæ£€æµ‹ (ä½¿ç”¨ç©ºé—´åˆ†å‰²æˆ–AABB)
        const potentialPairs = this.collisionSystem.broadPhase(this.bodies);
        
        // çª„é˜¶æ®µæ£€æµ‹ (ç²¾ç¡®ç¢°æ’æ£€æµ‹)
        for (let pair of potentialPairs) {
            this.stats.collisionChecks++;
            
            const bodyA = pair[0];
            const bodyB = pair[1];
            
            // å¦‚æœä¸¤ä¸ªç‰©ä½“éƒ½æ˜¯é™æ€çš„ï¼Œè·³è¿‡æ£€æµ‹
            if (bodyA.isStatic && bodyB.isStatic) continue;
            
            // æ‰§è¡Œç²¾ç¡®ç¢°æ’æ£€æµ‹
            const collision = this.collisionSystem.narrowPhase(bodyA, bodyB);
            
            if (collision) {
                // å¤„ç†ç¢°æ’
                this.resolveCollision(collision);
                
                // è®°å½•ç¢°æ’ä¿¡æ¯
                bodyA.collisions.push({
                    body: bodyB,
                    normal: collision.normal,
                    depth: collision.depth,
                    contactPoint: collision.contactPoint
                });
                
                bodyB.collisions.push({
                    body: bodyA,
                    normal: { 
                        x: -collision.normal.x, 
                        y: -collision.normal.y 
                    },
                    depth: collision.depth,
                    contactPoint: collision.contactPoint
                });
            }
        }
    }
    
    /**
     * è§£å†³ç¢°æ’
     */
    resolveCollision(collision) {
        const { bodyA, bodyB, normal, depth, contactPoint } = collision;
        
        // è®¡ç®—ç›¸å¯¹é€Ÿåº¦
        const relativeVelocity = {
            x: bodyB.velocity.x - bodyA.velocity.x,
            y: bodyB.velocity.y - bodyA.velocity.y
        };
        
        // è®¡ç®—ç›¸å¯¹é€Ÿåº¦åœ¨ç¢°æ’æ³•çº¿ä¸Šçš„åˆ†é‡
        const velocityAlongNormal = 
            relativeVelocity.x * normal.x + 
            relativeVelocity.y * normal.y;
        
        // å¦‚æœç‰©ä½“æ­£åœ¨åˆ†ç¦»ï¼Œä¸å¤„ç†ç¢°æ’
        if (velocityAlongNormal > 0) return;
        
        // è®¡ç®—æ¢å¤ç³»æ•°ï¼ˆå¼¹æ€§ï¼‰
        const restitution = Math.min(bodyA.restitution, bodyB.restitution);
        
        // è®¡ç®—å†²é‡æ ‡é‡
        let impulseScalar = -(1 + restitution) * velocityAlongNormal;
        
        // è€ƒè™‘æ—‹è½¬çš„æƒ¯æ€§
        const rA = {
            x: contactPoint.x - bodyA.position.x,
            y: contactPoint.y - bodyA.position.y
        };
        
        const rB = {
            x: contactPoint.x - bodyB.position.x,
            y: contactPoint.y - bodyB.position.y
        };
        
        const rAperpendicular = rA.x * normal.y - rA.y * normal.x;
        const rBperpendicular = rB.x * normal.y - rB.y * normal.x;
        
        const angularEffect = 
            bodyA.inverseInertia * rAperpendicular * rAperpendicular +
            bodyB.inverseInertia * rBperpendicular * rBperpendicular;
        
        impulseScalar /= (bodyA.inverseMass + bodyB.inverseMass + angularEffect);
        
        // åº”ç”¨å†²é‡
        const impulse = {
            x: normal.x * impulseScalar,
            y: normal.y * impulseScalar
        };
        
        if (!bodyA.isStatic) {
            bodyA.velocity.x -= impulse.x * bodyA.inverseMass;
            bodyA.velocity.y -= impulse.y * bodyA.inverseMass;
            bodyA.angularVelocity -= 
                (rA.x * impulse.y - rA.y * impulse.x) * bodyA.inverseInertia;
        }
        
        if (!bodyB.isStatic) {
            bodyB.velocity.x += impulse.x * bodyB.inverseMass;
            bodyB.velocity.y += impulse.y * bodyB.inverseMass;
            bodyB.angularVelocity += 
                (rB.x * impulse.y - rB.y * impulse.x) * bodyB.inverseInertia;
        }
        
        // ä½ç½®ä¿®æ­£ï¼ˆé˜²æ­¢ç‰©ä½“åµŒå…¥ï¼‰
        const percent = 0.8; // ç©¿é€ä¿®æ­£ç™¾åˆ†æ¯”
        const slop = 0.01;   // å…è®¸çš„å¾®å°ç©¿é€
        const correction = Math.max(depth - slop, 0) / 
                          (bodyA.inverseMass + bodyB.inverseMass) * percent;
        
        const correctionVector = {
            x: normal.x * correction,
            y: normal.y * correction
        };
        
        if (!bodyA.isStatic) {
            bodyA.position.x -= correctionVector.x * bodyA.inverseMass;
            bodyA.position.y -= correctionVector.y * bodyA.inverseMass;
        }
        
        if (!bodyB.isStatic) {
            bodyB.position.x += correctionVector.x * bodyB.inverseMass;
            bodyB.position.y += correctionVector.y * bodyB.inverseMass;
        }
    }
    
    /**
     * æ·»åŠ ç‰©ç†å®ä½“åˆ°ä¸–ç•Œ
     */
    addBody(body) {
        this.bodies.push(body);
        return body;
    }
    
    /**
     * ä»ä¸–ç•Œç§»é™¤ç‰©ç†å®ä½“
     */
    removeBody(body) {
        const index = this.bodies.indexOf(body);
        if (index > -1) {
            this.bodies.splice(index, 1);
        }
    }
    
    /**
     * æ¸…ç©ºæ‰€æœ‰ç‰©ç†å®ä½“
     */
    clear() {
        this.bodies = [];
        this.constraints = [];
    }
}</code></pre>
            </div>
            
            <h3 class="section-subtitle">æŠ€æœ¯ç¾æœ¯ç€è‰²å™¨ç¤ºä¾‹ (PhysicsShader.glsl)</h3>
            <div class="code-demo">
                <div class="code-header">
                    <div class="code-title">
                        <i class="fas fa-file-code"></i>
                        <span>physics-simulation/shaders/PhysicsShader.glsl</span>
                    </div>
                    <button class="copy-button" onclick="copyCode('code2')">
                        <i class="far fa-copy"></i> å¤åˆ¶ä»£ç 
                    </button>
                </div>
                <pre><code class="glsl" id="code2">/**
 * ç‰©ç†æ•ˆæœç€è‰²å™¨ - é¡¶ç‚¹ç€è‰²å™¨
 * å°†ç‰©ç†æ¨¡æ‹Ÿæ•°æ®åº”ç”¨äºç½‘æ ¼å˜å½¢
 */
#version 300 es
precision mediump float;

// é¡¶ç‚¹å±æ€§
in vec3 aPosition;
in vec3 aNormal;
in vec2 aTexCoord;

// ç‰©ç†æ¨¡æ‹Ÿæ•°æ®
in vec3 aVelocity;
in float aTemperature; // ç”¨äºçƒ­åŠ›å­¦æ•ˆæœ
in float aDeformation; // å½¢å˜æ•°æ®

// ç»Ÿä¸€å˜é‡
uniform mat4 uModelViewMatrix;
uniform mat4 uProjectionMatrix;
uniform mat3 uNormalMatrix;
uniform float uTime;

// ç‰©ç†å‚æ•°
uniform vec3 uGravity;
uniform float uWindStrength;
uniform vec3 uWindDirection;
uniform float uTurbulence;

// è¾“å‡ºåˆ°ç‰‡æ®µç€è‰²å™¨
out vec3 vNormal;
out vec2 vTexCoord;
out vec3 vWorldPosition;
out vec3 vVelocity;
out float vTemperature;
out float vDeformation;

// å™ªå£°å‡½æ•° (ç”¨äºç‰©ç†ç»†èŠ‚)
float noise(vec3 p) {
    return fract(sin(dot(p, vec3(12.9898, 78.233, 45.543))) * 43758.5453);
}

// æ¨¡æ‹Ÿé£åŠ›å½±å“
vec3 applyWind(vec3 position, vec3 normal) {
    // åŸºç¡€é£åŠ›
    vec3 wind = uWindDirection * uWindStrength;
    
    // æ·»åŠ æ¹æµ
    float turbulence = noise(position * 0.1 + uTime * 0.5) * 2.0 - 1.0;
    wind += normalize(cross(uWindDirection, vec3(0, 1, 0))) * turbulence * uTurbulence;
    
    // é£åŠ›éšé«˜åº¦å˜åŒ–
    float heightFactor = smoothstep(0.0, 10.0, position.y);
    wind *= heightFactor;
    
    // é£åŠ›å¯¹æ³•çº¿çš„å½±å“
    float windEffect = dot(normalize(normal), normalize(wind));
    windEffect = max(0.0, windEffect);
    
    return wind * windEffect;
}

// æ¨¡æ‹Ÿçƒ­åŠ›å­¦ä¸Šå‡
vec3 applyThermal(vec3 position, float temperature) {
    if (temperature <= 0.0) return vec3(0.0);
    
    // çƒ­ç©ºæ°”ä¸Šå‡æ•ˆåº”
    vec3 thermal = vec3(0.0, temperature * 0.5, 0.0);
    
    // çƒ­æ‰©æ•£æ•ˆæœ
    float diffusion = noise(position * 0.2) * 0.1;
    thermal += vec3(diffusion, 0.0, diffusion);
    
    return thermal;
}

void main() {
    // åŸå§‹ä½ç½®
    vec3 position = aPosition;
    vec3 normal = normalize(uNormalMatrix * aNormal);
    
    // åº”ç”¨ç‰©ç†æ•ˆæœ
    
    // 1. é£åŠ›å½±å“
    vec3 windEffect = applyWind(position, normal);
    position += windEffect * 0.1;
    
    // 2. çƒ­åŠ›å­¦æ•ˆåº”
    vec3 thermalEffect = applyThermal(position, aTemperature);
    position += thermalEffect;
    
    // 3. é€Ÿåº¦å½±å“ (åŸºäºç‰©ç†æ¨¡æ‹Ÿçš„é€Ÿåº¦)
    position += aVelocity * 0.05;
    
    // 4. å½¢å˜æ•ˆæœ
    if (aDeformation > 0.0) {
        // æ ¹æ®æ³•çº¿æ–¹å‘å½¢å˜
        position += normal * aDeformation * 0.2;
        
        // æ·»åŠ ç»†èŠ‚å™ªå£°
        float deformationNoise = noise(position * 2.0 + uTime);
        position += normal * deformationNoise * aDeformation * 0.05;
    }
    
    // 5. é‡åŠ›å½±å“ (è½»å¾®ä¸‹å‚æ•ˆæœ)
    position -= uGravity * 0.01;
    
    // è®¡ç®—æœ€ç»ˆä½ç½®
    vec4 viewPosition = uModelViewMatrix * vec4(position, 1.0);
    gl_Position = uProjectionMatrix * viewPosition;
    
    // ä¼ é€’æ•°æ®åˆ°ç‰‡æ®µç€è‰²å™¨
    vNormal = normal;
    vTexCoord = aTexCoord;
    vWorldPosition = position;
    vVelocity = aVelocity;
    vTemperature = aTemperature;
    vDeformation = aDeformation;
}</code></pre>
            </div>
        </section>

        <!-- æ–‡ä»¶ç»“æ„ -->
        <section class="page-section" id="file-structure">
            <h2 class="section-title">é¡¹ç›®æ–‡ä»¶ç»“æ„</h2>
            
            <div class="file-structure">
                <div class="file-tree">
                    <ul>
                        <li>physics-simulation/
                            <ul>
                                <li>core/ (æ ¸å¿ƒå¼•æ“)
                                    <ul>
                                        <li class="js-file">PhysicsEngine.js</li>
                                        <li class="js-file">CollisionSystem.js</li>
                                        <li class="js-file">RigidBody.js</li>
                                        <li class="js-file">SoftBody.js</li>
                                        <li class="js-file">ParticleSystem.js</li>
                                        <li class="js-file">ConstraintSolver.js</li>
                                    </ul>
                                </li>
                                <li>tech-art/ (æŠ€æœ¯ç¾æœ¯)
                                    <ul>
                                        <li class="shader-file">PhysicsShader.glsl</li>
                                        <li class="shader-file">DeformationShader.glsl</li>
                                        <li class="js-file">MaterialSystem.js</li>
                                        <li class="js-file">PostProcessing.js</li>
                                        <li class="js-file">VisualEffects.js</li>
                                    </ul>
                                </li>
                                <li>animation/ (åŠ¨ç”»å¼•æ“)
                                    <ul>
                                        <li class="js-file">PhysicsAnimation.js</li>
                                        <li class="js-file">InverseKinematics.js</li>
                                        <li class="js-file">ClothSimulation.js</li>
                                        <li class="js-file">HairSimulation.js</li>
                                        <li class="js-file">BlendShapeController.js</li>
                                    </ul>
                                </li>
                                <li>scene-art/ (åœºæ™¯è‰ºæœ¯)
                                    <ul>
                                        <li class="scene-file">DestructibleTerrain.js</li>
                                        <li class="scene-file">VegetationSystem.js</li>
                                        <li class="scene-file">WaterSimulation.js</li>
                                        <li class="scene-file">DynamicLighting.js</li>
                                        <li class="scene-file">WeatherSystem.js</li>
                                    </ul>
                                </li>
                                <li>demos/ (æ¼”ç¤ºæ¡ˆä¾‹)
                                    <ul>
                                        <li class="file">rigid-body-demo.html</li>
                                        <li class="file">cloth-simulation.html</li>
                                        <li class="file">fluid-dynamics.html</li>
                                        <li class="file">destructible-scene.html</li>
                                    </ul>
                                </li>
                                <li class="file">README.md (è¯´æ˜æ–‡æ¡£)</li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
            
            <p>é¡¹ç›®é‡‡ç”¨æ¨¡å—åŒ–ç»“æ„ï¼Œæ¯ä¸ªæ¨¡å—è´Ÿè´£ç‰¹å®šçš„åŠŸèƒ½ã€‚æ ¸å¿ƒå¼•æ“æä¾›åŸºç¡€ç‰©ç†æ¨¡æ‹Ÿï¼ŒæŠ€æœ¯ç¾æœ¯æ¨¡å—è´Ÿè´£è§†è§‰æ•ˆæœï¼ŒåŠ¨ç”»å¼•æ“å¤„ç†åŸºäºç‰©ç†çš„åŠ¨ç”»ï¼Œåœºæ™¯è‰ºæœ¯æ¨¡å—åˆ›å»ºäº¤äº’å¼ç¯å¢ƒã€‚</p>
        </section>

        <!-- æ¡ˆä¾‹ç ”ç©¶ -->
        <section class="page-section" id="case-studies">
            <h2 class="section-title">åº”ç”¨æ¡ˆä¾‹</h2>
            
            <div class="tech-grid">
                <div class="tech-card tech-art">
                    <h4>åŸºäºç‰©ç†çš„ç ´åæ•ˆæœ</h4>
                    <p>å®ç°å¯ç ´åçš„å»ºç­‘ç‰©å’Œåœ°å½¢ï¼Œç¢ç‰‡éµå¾ªç‰©ç†è§„å¾‹é£æ•£ï¼Œäº§ç”Ÿé€¼çœŸçš„ç ´åæ•ˆæœã€‚</p>
                    <ul class="tech-features">
                        <li><i class="fas fa-cube"></i> é¢„ç ´ç¢å‡ ä½•ä½“</li>
                        <li><i class="fas fa-bolt"></i> å†²å‡»æ³¢ä¼ æ’­</li>
                        <li><i class="fas fa-layer-group"></i> å±‚æ¬¡ç ´åç³»ç»Ÿ</li>
                    </ul>
                </div>
                
                <div class="tech-card animation">
                    <h4>è§’è‰²å¸ƒæ–™ä¸å¤´å‘æ¨¡æ‹Ÿ</h4>
                    <p>ä½¿ç”¨ç‰©ç†å¼•æ“é©±åŠ¨è§’è‰²æœè£…å’Œå¤´å‘çš„åŠ¨æ€æ•ˆæœï¼Œå®ç°é€¼çœŸçš„å¸ƒæ–™æ‘†åŠ¨å’Œå¤´å‘é£˜åŠ¨ã€‚</p>
                    <ul class="tech-features">
                        <li><i class="fas fa-tshirt"></i> å¸ƒæ–™çº¦æŸæ±‚è§£</li>
                        <li><i class="fas fa-user"></i> è§’è‰²ç¢°æ’ä½“ç§¯</li>
                        <li><i class="fas fa-wind"></i> é£åŠ›å½±å“</li>
                    </ul>
                </div>
                
                <div class="tech-card scene-art">
                    <h4>äº¤äº’å¼è‡ªç„¶ç¯å¢ƒ</h4>
                    <p>åˆ›å»ºå¯¹ç©å®¶åŠ¨ä½œæœ‰ååº”çš„æ¤è¢«ã€æ°´ä½“å’Œåœ°å½¢ï¼Œå¢å¼ºæ¸¸æˆçš„æ²‰æµ¸æ„Ÿå’ŒçœŸå®æ„Ÿã€‚</p>
                    <ul class="tech-features">
                        <li><i class="fas fa-tree"></i> ç‰©ç†é©±åŠ¨æ¤è¢«</li>
                        <li><i class="fas fa-water"></i> äº¤äº’å¼æ°´ä½“</li>
                        <li><i class="fas fa-mountain"></i> å¯å˜å½¢åœ°å½¢</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- ç›¸å…³èµ„æº -->
        <section class="page-section">
            <h2 class="section-title">ç›¸å…³èµ„æºä¸é“¾æ¥</h2>
            
            <p>ä»¥ä¸‹æ˜¯ä¸ç‰©ç†å¼•æ“æ¨¡æ‹Ÿç›¸å…³çš„èµ„æºå’Œæ–‡æ¡£é“¾æ¥ï¼š</p>
            
            <div class="resource-links">
                <a href="https://github.com/yourusername/physics-simulation" class="resource-link" target="_blank">
                    <i class="fab fa-github"></i> æŸ¥çœ‹å®Œæ•´æºä»£ç 
                </a>
                
                <a href="../game-scripts/rpg-system.html" class="resource-link">
                    <i class="fas fa-code"></i> RPGæˆ˜æ–—ç³»ç»Ÿ
                </a>
                
                <a href="../art-resources/visual-effects.html" class="resource-link">
                    <i class="fas fa-fire"></i> è§†è§‰ç‰¹æ•ˆèµ„æº
                </a>
                
                <a href="../live2d-editor/character-model.html" class="resource-link">
                    <i class="fas fa-user"></i> Live2Dè§’è‰²æ¨¡å‹
                </a>
                
                <a href="https://threejs.org/" class="resource-link" target="_blank">
                    <i class="fas fa-cube"></i> Three.js 3Dåº“
                </a>
                
                <a href="https://github.com/schteppe/cannon.js" class="resource-link" target="_blank">
                    <i class="fas fa-bomb"></i> Cannon.js ç‰©ç†å¼•æ“
                </a>
            </div>
        </section>

        <!-- é¡µé¢å¯¼èˆª -->
        <div class="page-navigation">
            <a href="../index.html" class="nav-button">
                <i class="fas fa-home"></i> è¿”å›ä¸»é¡µé¢
            </a>
            
            <div>
                <a href="rpg-system.html" class="nav-button">
                    <i class="fas fa-arrow-left"></i> ä¸Šä¸€ä¸ª: RPGæˆ˜æ–—ç³»ç»Ÿ
                </a>
                <a href="../live2d-editor/character-model.html" class="nav-button">
                    ä¸‹ä¸€ä¸ª: Live2Dè§’è‰²æ¨¡å‹ <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
    </main>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
    <script>
        // åˆå§‹åŒ–ä»£ç é«˜äº®
        document.addEventListener('DOMContentLoaded', function() {
            hljs.highlightAll();
            
            // åˆå§‹åŒ–ç‰©ç†æ¼”ç¤º
            initPhysicsDemo();
        });
        
        // å¤åˆ¶ä»£ç åŠŸèƒ½
        function copyCode(codeId) {
            const codeElement = document.getElementById(codeId);
            const textToCopy = codeElement.textContent;
            
            navigator.clipboard.writeText(textToCopy).then(() => {
                // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
                const button = event.target.closest('.copy-button');
                const originalHTML = button.innerHTML;
                
                button.innerHTML = '<i class="fas fa-check"></i> å·²å¤åˆ¶';
                button.style.backgroundColor = 'rgba(76, 175, 80, 0.2)';
                button.style.color = '#4CAF50';
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.style.backgroundColor = '';
                    button.style.color = '';
                }, 2000);
            }).catch(err => {
                console.error('å¤åˆ¶å¤±è´¥: ', err);
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©æ–‡æœ¬å¤åˆ¶');
            });
        }
        
        // å¹³æ»‘æ»šåŠ¨åˆ°é”šç‚¹
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                
                if (targetElement) {
                    e.preventDefault();
                    window.scrollTo({
                        top: targetElement.offsetTop - 100,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // ç‰©ç†æ¼”ç¤ºåŠŸèƒ½
        function initPhysicsDemo() {
            const canvas = document.getElementById('physicsCanvas');
            const ctx = canvas.getContext('2d');
            
            // è®¾ç½®canvaså°ºå¯¸
            canvas.width = canvas.offsetWidth;
            canvas.height = canvas.offsetHeight;
            
            // ç‰©ç†å¯¹è±¡
            let objects = [];
            let gravityEnabled = true;
            
            // ç‰©ç†å‚æ•°
            const gravity = 0.5;
            const friction = 0.99;
            const restitution = 0.8;
            
            // å¯¹è±¡ç±»
            class PhysicsObject {
                constructor(x, y, type, color) {
                    this.x = x;
                    this.y = y;
                    this.vx = (Math.random() - 0.5) * 8;
                    this.vy = (Math.random() - 0.5) * 8;
                    this.type = type; // 'box', 'circle', 'polygon'
                    this.color = color || this.getRandomColor();
                    this.rotation = 0;
                    this.angularVelocity = (Math.random() - 0.5) * 0.1;
                    
                    if (type === 'box') {
                        this.width = 30 + Math.random() * 30;
                        this.height = 30 + Math.random() * 30;
                    } else if (type === 'circle') {
                        this.radius = 15 + Math.random() * 20;
                    } else if (type === 'polygon') {
                        this.sides = 5 + Math.floor(Math.random() * 4);
                        this.radius = 20 + Math.random() * 20;
                        this.points = this.generatePolygonPoints();
                    }
                }
                
                getRandomColor() {
                    const colors = [
                        '#4361ee', '#3a0ca3', '#4cc9f0', 
                        '#f72585', '#7209b7', '#38b000'
                    ];
                    return colors[Math.floor(Math.random() * colors.length)];
                }
                
                generatePolygonPoints() {
                    const points = [];
                    for (let i = 0; i < this.sides; i++) {
                        const angle = (i / this.sides) * Math.PI * 2 + this.rotation;
                        points.push({
                            x: this.x + Math.cos(angle) * this.radius,
                            y: this.y + Math.sin(angle) * this.radius
                        });
                    }
                    return points;
                }
                
                update() {
                    // åº”ç”¨é‡åŠ›
                    if (gravityEnabled) {
                        this.vy += gravity;
                    }
                    
                    // åº”ç”¨æ‘©æ“¦åŠ›
                    this.vx *= friction;
                    this.vy *= friction;
                    
                    // æ›´æ–°ä½ç½®
                    this.x += this.vx;
                    this.y += this.vy;
                    
                    // æ›´æ–°æ—‹è½¬
                    this.rotation += this.angularVelocity;
                    this.angularVelocity *= 0.98;
                    
                    // è¾¹ç•Œç¢°æ’
                    this.handleBoundaryCollision();
                    
                    // æ›´æ–°å¤šè¾¹å½¢ç‚¹
                    if (this.type === 'polygon') {
                        this.points = this.generatePolygonPoints();
                    }
                }
                
                handleBoundaryCollision() {
                    if (this.type === 'box') {
                        if (this.x - this.width/2 < 0) {
                            this.x = this.width/2;
                            this.vx = Math.abs(this.vx) * restitution;
                        } else if (this.x + this.width/2 > canvas.width) {
                            this.x = canvas.width - this.width/2;
                            this.vx = -Math.abs(this.vx) * restitution;
                        }
                        
                        if (this.y - this.height/2 < 0) {
                            this.y = this.height/2;
                            this.vy = Math.abs(this.vy) * restitution;
                        } else if (this.y + this.height/2 > canvas.height) {
                            this.y = canvas.height - this.height/2;
                            this.vy = -Math.abs(this.vy) * restitution;
                        }
                    } else if (this.type === 'circle') {
                        if (this.x - this.radius < 0) {
                            this.x = this.radius;
                            this.vx = Math.abs(this.vx) * restitution;
                        } else if (this.x + this.radius > canvas.width) {
                            this.x = canvas.width - this.radius;
                            this.vx = -Math.abs(this.vx) * restitution;
                        }
                        
                        if (this.y - this.radius < 0) {
                            this.y = this.radius;
                            this.vy = Math.abs(this.vy) * restitution;
                        } else if (this.y + this.radius > canvas.height) {
                            this.y = canvas.height - this.radius;
                            this.vy = -Math.abs(this.vy) * restitution;
                        }
                    } else if (this.type === 'polygon') {
                        // ç®€å•è¾¹ç•Œæ£€æµ‹
                        let minX = Math.min(...this.points.map(p => p.x));
                        let maxX = Math.max(...this.points.map(p => p.x));
                        let minY = Math.min(...this.points.map(p => p.y));
                        let maxY = Math.max(...this.points.map(p => p.y));
                        
                        if (minX < 0) {
                            const offset = -minX;
                            this.x += offset;
                            this.vx = Math.abs(this.vx) * restitution;
                        } else if (maxX > canvas.width) {
                            const offset = canvas.width - maxX;
                            this.x += offset;
                            this.vx = -Math.abs(this.vx) * restitution;
                        }
                        
                        if (minY < 0) {
                            const offset = -minY;
                            this.y += offset;
                            this.vy = Math.abs(this.vy) * restitution;
                        } else if (maxY > canvas.height) {
                            const offset = canvas.height - maxY;
                            this.y += offset;
                            this.vy = -Math.abs(this.vy) * restitution;
                        }
                    }
                }
                
                draw() {
                    ctx.save();
                    ctx.fillStyle = this.color;
                    ctx.strokeStyle = '#ffffff';
                    ctx.lineWidth = 2;
                    
                    if (this.type === 'box') {
                        ctx.translate(this.x, this.y);
                        ctx.rotate(this.rotation);
                        ctx.fillRect(-this.width/2, -this.height/2, this.width, this.height);
                        ctx.strokeRect(-this.width/2, -this.height/2, this.width, this.height);
                    } else if (this.type === 'circle') {
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
                        ctx.fill();
                        ctx.stroke();
                        
                        // ç»˜åˆ¶æ–¹å‘çº¿
                        ctx.beginPath();
                        ctx.moveTo(this.x, this.y);
                        ctx.lineTo(
                            this.x + Math.cos(this.rotation) * this.radius,
                            this.y + Math.sin(this.rotation) * this.radius
                        );
                        ctx.strokeStyle = '#ffffff';
                        ctx.lineWidth = 2;
                        ctx.stroke();
                    } else if (this.type === 'polygon') {
                        ctx.beginPath();
                        ctx.moveTo(this.points[0].x, this.points[0].y);
                        for (let i = 1; i < this.points.length; i++) {
                            ctx.lineTo(this.points[i].x, this.points[i].y);
                        }
                        ctx.closePath();
                        ctx.fill();
                        ctx.stroke();
                        
                        // ç»˜åˆ¶ä¸­å¿ƒç‚¹
                        ctx.beginPath();
                        ctx.arc(this.x, this.y, 3, 0, Math.PI * 2);
                        ctx.fillStyle = '#ffffff';
                        ctx.fill();
                    }
                    
                    ctx.restore();
                }
            }
            
            // ç¢°æ’æ£€æµ‹ï¼ˆç®€åŒ–çš„AABBæ£€æµ‹ï¼‰
            function checkCollisions() {
                for (let i = 0; i < objects.length; i++) {
                    for (let j = i + 1; j < objects.length; j++) {
                        const objA = objects[i];
                        const objB = objects[j];
                        
                        // ç®€åŒ–çš„ç¢°æ’æ£€æµ‹å’Œå“åº”
                        if (objA.type === 'circle' && objB.type === 'circle') {
                            const dx = objB.x - objA.x;
                            const dy = objB.y - objA.y;
                            const distance = Math.sqrt(dx * dx + dy * dy);
                            const minDistance = objA.radius + objB.radius;
                            
                            if (distance < minDistance) {
                                // ç¢°æ’å“åº”
                                const angle = Math.atan2(dy, dx);
                                const targetX = objA.x + Math.cos(angle) * minDistance;
                                const targetY = objA.y + Math.sin(angle) * minDistance;
                                
                                const ax = (targetX - objB.x) * 0.05;
                                const ay = (targetY - objB.y) * 0.05;
                                
                                objA.vx -= ax;
                                objA.vy -= ay;
                                objB.vx += ax;
                                objB.vy += ay;
                                
                                // è½»å¾®çš„é¢œè‰²å˜åŒ–è¡¨ç¤ºç¢°æ’
                                objA.color = '#ff6b6b';
                                objB.color = '#ff6b6b';
                            }
                        }
                    }
                }
            }
            
            // åŠ¨ç”»å¾ªç¯
            function animate() {
                // æ¸…ç©ºç”»å¸ƒ
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                
                // ç»˜åˆ¶èƒŒæ™¯
                ctx.fillStyle = 'rgba(26, 26, 46, 0.2)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // ç»˜åˆ¶ç½‘æ ¼
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
                ctx.lineWidth = 1;
                const gridSize = 30;
                for (let x = 0; x < canvas.width; x += gridSize) {
                    ctx.beginPath();
                    ctx.moveTo(x, 0);
                    ctx.lineTo(x, canvas.height);
                    ctx.stroke();
                }
                for (let y = 0; y < canvas.height; y += gridSize) {
                    ctx.beginPath();
                    ctx.moveTo(0, y);
                    ctx.lineTo(canvas.width, y);
                    ctx.stroke();
                }
                
                // æ›´æ–°å’Œç»˜åˆ¶æ‰€æœ‰å¯¹è±¡
                objects.forEach(obj => {
                    obj.update();
                    obj.draw();
                    
                    // é‡ç½®é¢œè‰²ï¼ˆå¦‚æœä¹‹å‰å› ç¢°æ’æ”¹å˜ï¼‰
                    if (obj.color === '#ff6b6b') {
                        setTimeout(() => {
                            obj.color = obj.getRandomColor();
                        }, 300);
                    }
                });
                
                // æ£€æµ‹ç¢°æ’
                checkCollisions();
                
                // é™åˆ¶å¯¹è±¡æ•°é‡
                if (objects.length > 20) {
                    objects = objects.slice(-20);
                }
                
                requestAnimationFrame(animate);
            }
            
            // å¯åŠ¨åŠ¨ç”»
            animate();
            
            // æ·»åŠ äº¤äº’åŠŸèƒ½
            document.getElementById('addBoxBtn').addEventListener('click', () => {
                const x = canvas.width / 2;
                const y = 50;
                objects.push(new PhysicsObject(x, y, 'box'));
            });
            
            document.getElementById('addCircleBtn').addEventListener('click', () => {
                const x = canvas.width / 2;
                const y = 50;
                objects.push(new PhysicsObject(x, y, 'circle'));
            });
            
            document.getElementById('addPolygonBtn').addEventListener('click', () => {
                const x = canvas.width / 2;
                const y = 50;
                objects.push(new PhysicsObject(x, y, 'polygon'));
            });
            
            document.getElementById('toggleGravityBtn').addEventListener('click', () => {
                gravityEnabled = !gravityEnabled;
                const btn = document.getElementById('toggleGravityBtn');
                if (gravityEnabled) {
                    btn.innerHTML = '<i class="fas fa-weight-hanging"></i> å…³é—­é‡åŠ›';
                } else {
                    btn.innerHTML = '<i class="fas fa-weight-hanging"></i> å¼€å¯é‡åŠ›';
                }
            });
            
            document.getElementById('resetBtn').addEventListener('click', () => {
                objects = [];
                gravityEnabled = true;
                document.getElementById('toggleGravityBtn').innerHTML = 
                    '<i class="fas fa-weight-hanging"></i> å…³é—­é‡åŠ›';
            });
            
            // çª—å£å¤§å°è°ƒæ•´
            window.addEventListener('resize', () => {
                canvas.width = canvas.offsetWidth;
                canvas.height = canvas.offsetHeight;
            });
        }
    </script>
</body>
</html>
